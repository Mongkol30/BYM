<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="${appName}">BeeryYummyMap</title>

    <!-- Leaflet CSS -->
    <link
            rel="stylesheet"
            href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
            integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
            crossorigin=""
    />



    <style>
        body {
            margin: 0;
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background: #fef9ff;
        }

        header {
            padding: 12px 20px;
            background: linear-gradient(90deg, #ffb6c9, #ffe29f);
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: 0 2px 6px rgba(0,0,0,0.1);
        }

        .logo {
            font-weight: 700;
            font-size: 1.2rem;
        }

        .logo span {
            font-size: 1.5rem;
        }

        .tagline {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        #map {
            height: calc(100vh - 60px); /* ‡πÄ‡∏ï‡πá‡∏°‡∏à‡∏≠ ‡∏•‡∏ö‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á header */
            width: 100vw;
        }

        .leaflet-container {
            background: #fdf5ff;
        }

        .floating-btn {
            position: fixed;
            bottom: 20px;       /* ‡∏´‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏Ç‡∏≠‡∏ö‡∏•‡πà‡∏≤‡∏á */
            right: 20px;        /* ‡∏´‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏Ç‡∏≠‡∏ö‡∏Ç‡∏ß‡∏≤ */
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: none;
            font-size: 32px;
            color: white;
            background: #ff6fa8; /* ‡∏ä‡∏°‡∏û‡∏π‡∏™‡∏î‡πÉ‡∏™ */
            box-shadow: 0 4px 12px rgba(0,0,0,0.25);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;

            transition: all 0.2s ease;
            z-index: 9999;
        }

        /* ‡πÄ‡∏≠‡∏ü‡πÄ‡∏ü‡∏Å‡∏ï‡πå hover */
        .floating-btn:hover {
            transform: scale(1.08);
            background: #ff85bc;
        }

        .beer-pin {
            font-size: 28px;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
        }
    </style>
</head>
<body>

<header>
    <div class="logo">
        <span>üç∫</span> <span th:text="${appName}"></span>
    </div>
    <div class="tagline">
        ‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏ß‡∏°‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏£‡πà‡∏≠‡∏¢‡∏Ç‡∏≠‡∏á‡πÄ‡∏ö‡∏µ‡∏¢‡∏£‡πå
    </div>
</header>

<div id="map"></div>
<button id="addBtn" class="floating-btn">+</button>


<script
        src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
        integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
        crossorigin="">
</script>

<script>
    document.addEventListener("DOMContentLoaded", function () {

        const fallbackLat = 13.7563;
        const fallbackLng = 100.5018;
        const fallbackZoom = 12;

        // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏î‡πâ‡∏ß‡∏¢‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á fallback ‡∏Å‡πà‡∏≠‡∏ô
        const map = L.map('map').setView([fallbackLat, fallbackLng], fallbackZoom);

        // ‡πÉ‡∏™‡πà tile layer (theme ‡∏ô‡πà‡∏≤‡∏£‡∏±‡∏Å‡∏à‡∏≤‡∏Å Stadia)
        L.tileLayer('https://tiles.stadiamaps.com/tiles/alidade_smooth/{z}/{x}/{y}.png', {
            maxZoom: 20,
            attribution: '&copy; Stadia Maps'
        }).addTo(map);


        // ‡∏Ç‡∏≠‡∏û‡∏¥‡∏Å‡∏±‡∏î‡∏à‡∏£‡∏¥‡∏á‡∏à‡∏≤‡∏Å‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(
                function (pos) {
                    const userLat = pos.coords.latitude;
                    const userLng = pos.coords.longitude;

                    // ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô map ‡πÑ‡∏õ‡∏ï‡∏≥‡πÅ‡∏´‡∏ô‡πà‡∏á‡∏à‡∏£‡∏¥‡∏á‡∏Ç‡∏≠‡∏á‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ
                    map.setView([userLat, userLng], 14);

                    // ------------------------------
                    // ‡∏´‡∏°‡∏∏‡∏î 1 : ‡πÅ‡∏ö‡∏ö "‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û" üç∞
                    // ------------------------------
                    const cafeIcon = L.icon({
                        iconUrl: 'https://s359.kapook.com/pagebuilder/198c4942-4dc2-481a-9818-21b23e9cdf4f.jpg', // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô url ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢
                        iconSize: [60, 60],
                        iconAnchor: [20, 40],
                        popupAnchor: [0, -35]
                    });

                    L.marker([userLat + 0.01, userLng + 0.01], { icon: cafeIcon })
                        .bindPopup("‡∏´‡∏°‡∏∏‡∏î‡πÅ‡∏ö‡∏ö‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û üç∞")
                        .addTo(map);

                    // ------------------------------
                    // ‡∏´‡∏°‡∏∏‡∏î 2 : ‡πÅ‡∏ö‡∏ö "icon div" üç∫
                    // ------------------------------
                    const beerIcon = L.divIcon({
                        html: '<div class="beer-pin">üç∫</div>',
                        className: '',      // ‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πâ class default ‡∏Ç‡∏≠‡∏á leaflet
                        iconSize: [60, 60],
                        iconAnchor: [16, 32]
                    });

                    L.marker([userLat - 0.01, userLng - 0.01], { icon: beerIcon })
                        .bindPopup("‡∏´‡∏°‡∏∏‡∏î‡πÅ‡∏ö‡∏ö icon üç∫")
                        .addTo(map);

                },
                function (err) {
                    console.warn("‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏°‡πà‡∏≠‡∏ô‡∏∏‡∏ç‡∏≤‡∏ï‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ location ‡∏´‡∏£‡∏∑‡∏≠‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤:", err);
                    // ‡∏ñ‡πâ‡∏≤ error ‡∏Å‡πá‡πÉ‡∏ä‡πâ fallback ‡∏ï‡πà‡∏≠‡πÑ‡∏õ
                }
            );
        } else {
            console.warn("‡πÄ‡∏ö‡∏£‡∏≤‡∏ß‡πå‡πÄ‡∏ã‡∏≠‡∏£‡πå‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö geolocation");
        }

        // ‡∏õ‡∏∏‡πà‡∏° +
        const addBtn = document.getElementById("addBtn");
        if (addBtn) {
            addBtn.addEventListener("click", () => {
                <!-- alert("‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏° + (‡πÑ‡∏ß‡πâ‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏¥‡∏î‡∏ü‡∏≠‡∏£‡πå‡∏°‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡πâ‡∏≤‡∏ô‡∏ó‡∏µ‡∏´‡∏•‡∏±‡∏á)");-->
                window.location.href = "/add";
            });
        }
    });
</script>


</body>
</html>
